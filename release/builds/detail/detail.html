<div class="detail-new-bg builds-detail"> <div class="detail-tit detail-new-header"> <div class="detail-title" layout="row"> <h2 flex="70" style="font-size: 24px;font-weight: 500;"> <a ui-sref="builds" class="back">构建</a> / {{$ctrl.repoInfo.full_name}}</h2> <div class="f12" flex="30"> <div layout="row"> <label flex="50">距上次构建结束时间:</label> <i class="icon-clock-block"></i>&nbsp;&nbsp; <span ng-if="$ctrl.repoInfo.created_at !=null"> {{$ctrl.repoInfo.created_at*1000 | relativeTime}} </span> <span ng-if="$ctrl.repoInfo.created_at==null">--</span> </div> <div layout="row"> <label flex="50">构建持续时间:</label> <i class="icon-clock"></i>&nbsp;&nbsp; <span ng-if="$ctrl.repoInfo.finished_at!=null&&($ctrl.repoInfo.finished_at - $ctrl.repoInfo.started_at) > 0"> {{$ctrl.repoInfo.finished_at - $ctrl.repoInfo.started_at}} seconds </span> <span ng-if="$ctrl.repoInfo.finished_at == null||$ctrl.repoInfo.finished_at == 0">--</span> </div> </div> </div> </div> <md-card class="detail-new-tab"> <md-tabs md-selected="$ctrl.selectedIndex"> <md-tab label="构建" ui-sref="buildslist({owner:$ctrl.repoInfo.owner,name:$ctrl.repoInfo.name})"> <md-tab-body> <div ui-view="content" flex></div> </md-tab-body> </md-tab> <md-tab label="密钥"> <md-tab-body> <form name="secretsForm" id="secretsForm" novalidate class="form-horizontal m-t-md"> <div layout="row" layout-wrap class="p-a-md"> <div flex="35"> <md-input-container md-no-float class="md-block"> <label class="col-sm-3 control-label col-sm-offset-1 md-required"> <span style="color:red">* </span>{{"SECRETS NAME"|I18N}}:</label> <input ng-model="$ctrl.secretName" type="text" name="name" placeholder="{{'Please enter a secrets name'|I18N}}" ng-maxlength="30"> <div class="error" ng-messages="secretsForm.name.$error"> <div ng-message="required">{{"Please enter a secrets name"|I18N}}</div> <div ng-message="maxlength">{{"The secret name must not exceed 30 characters"|I18N}}</div> </div> </md-input-container> </div> <div flex="60"> <md-input-container md-no-float class="md-block"> <label class="col-sm-3 control-label col-sm-offset-1 md-required"> <span style="color:red">* </span>{{"SECRETS VALUE"|I18N}}:</label> <input ng-model="$ctrl.secretValue" type="text" name="value" placeholder="{{'Please enter a secret value'|I18N}}"> <div class="error" ng-messages="secretsForm.value.$error"> <div ng-message="required">{{"Please enter a secret value"|I18N}}</div> <div ng-message="maxlength">The secrets name must not exceed 30 characters</div> </div> </md-input-container> </div> <div flex="5"> <button class="icon-plus-circle fw secrets-add-btn" ng-disabled="secretsForm.$invalid" ng-click="$ctrl.addSecret()"></button> </div> <div flex="95"> <div class="secrets-list"> <p ng-repeat="(k,item) in $ctrl.secretData"> <span class="secrets-name" style="position: relative;top: -26px;">{{item.name}}</span> <span class="secrets-value"> <span ng-repeat="(key,value) in item.eventObj"> <md-input-container> <md-checkbox class="md-primary" ng-model="$ctrl.secretData[k].eventObj[key]" aria-label="{{key}}">{{key|I18N}}</md-checkbox> </md-input-container> </span> </span> <button class="icon-minus-circle fw" ng-click="$ctrl.deleteSecret(item, $event)"></button> </p> </div> </div> </div> <div style="margin-left: 400px" class="m-t-lg"> <md-button ng-disabled="" ng-click="$ctrl.saveSecret($ctrl.secretData)" class="btn btn-success"> 保存密钥 </md-button> <span flex></span> </div> </form> </md-tab-body> </md-tab> <md-tab label="设置"> <md-tab-body> <div layout="row" layout-wrap class="accounts-title"> <div class="description"> 设置：可以在这里修改构建的配置信息，当一个仓库被激活，会自动将hooks添加到对应的版本控制系统中，可以配置何种情 况下自动触发hooks，进而触发工作流执行。 </div> </div> <form name="SettingsForm" id="SettingsForm" novalidate class="m-t-md p-a-md"> <div class="settings"> <h3>版本库</h3> <md-input-container> <md-checkbox class="md-primary" ng-model="$ctrl.settings.allow_push" aria-label="push">提交</md-checkbox> <md-checkbox class="md-primary" ng-model="$ctrl.settings.allow_pr" aria-label="pullrequest">合并请求</md-checkbox> <md-checkbox class="md-primary" ng-model="$ctrl.settings.allow_tag" aria-label="tag">标签</md-checkbox> <md-checkbox class="md-primary" ng-model="$ctrl.settings.allow_deploy" aria-label="deployment">部署</md-checkbox> </md-input-container> <h3>项目设置</h3> <md-input-container> <md-checkbox class="md-primary" ng-model="$ctrl.settings.gated" aria-label="Protected">受保护</md-checkbox> <md-checkbox class="md-primary" ng-model="$ctrl.settings.trusted" aria-label="Trusted">可信任</md-checkbox> </md-input-container> <h3>项目可见性</h3> <md-radio-group ng-model="$ctrl.settings.visibility"> <md-radio-button value="public" class="md-primary">公有</md-radio-button> <md-radio-button value="private" class="md-primary">私有</md-radio-button> <md-radio-button value="internal" class="md-primary">内部</md-radio-button> </md-radio-group> <h3>超时时间</h3> <md-input-container md-no-float class="md-block"> <input ng-model="$ctrl.settings.timeout" type="number" name="Timeout" value="60" required placeholder="60" style="width:60px;"> <span style="position: absolute;top: 7px">分钟</span> </md-input-container> </div> <div style="margin-left: 400px" class="m-t-lg"> <md-button ng-disabled="" ng-click="$ctrl.saveSettings($ctrl.settings)" class="btn btn-success"> 保存设置 </md-button> <span flex></span> </div> </form> </md-tab-body> </md-tab> <md-tab label="蓝绿部署" ui-sref="bluegreen({owner:$ctrl.repoInfo.owner,name:$ctrl.repoInfo.name})"> <md-tab-body> <div ui-view="content" flex></div> </md-tab-body> </md-tab> </md-tabs> </md-card> </div>